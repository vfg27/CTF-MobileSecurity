# Solution

## Description of the problem

The nojumpstarts challenge requires to inspect the contents of a builded apk to obtain information about the app, execute a custom app in the server and obtain the flag.

## Solution

First of all, I debugged the apk in Android Studio. Inside the app I obtained the resources, the manifest and the .dex files. In these files, I can see the bytecode of the classes in Smali. To facilitate me the work, I used an app (jadx) to translate the Smali code to Java code. There I found the MainActivity class. In that class exists the method getFlag(). This method calls the function buildIntent(String src, String dst, String chain). This method creates an Intent with component name ("com.mobisec.nojumpstarts", "com.mobisec.nojumpstarts." + dst) and put two extras in it. The first extra added is a String that is formed by the chain + "/" + src + "-to-" + dst (e.g: Main-to-A/A-to-B/B-to-C). The second extra is a signature created with this String. To create the signature the function sign(String msg) is called. This function extraxt the bytes from the String and sign them with the private key using a SHA-256 with RSA algorithm. This Intent is launched in order to arrive the Activity A. When received it, the activity checks if the extras are correct. If they are OK, it creates another intent, using the same method but in this case following the chain created, being the destination the Activity B. The activity B checking procedure is really similar to the one in Activity A. If everything is right, it continues the intent chain to Activity C. The activity C checking procedure is really similar to the one in Activity A and Activity B, but in this case it creates another Intent using the function reply(). This Intent is much simpler. It adds the flag with the key "flag" and sends it back to the Activity B. The Activity B sends it to the Activity A and the Activity A to the MainActivity (where the getFlag() function is called).

With all this information I decided to develop a custom app in Android Studio. The main functionality of this app resides in the MainActivity. I copied all the methods to create the intents as the nojumpstarts challenge, including the private and public keys that were stored into Strings in Main class. Then I created the Intent to start the chain as the MainActivity in the nojumpstarts challenge would do. However, the Activity A and B were not exported so I could not recreate the chain. On the other hand, the activity C had an Intent Filter with action "mobisec.intent.getflag". So, I went directly to the Activity C. I knew the message it has to receive, I copied the signing function, I added the action to the intent... I just needed to launch the Intent and receive the answer. I extracted the contents of the received intent and I printed them, receiving the flag: MOBISEC{you_shall_not_jump_ok?pretty_please?}.

## Optional Feedback

I think this challenge is good for reviewing the Intents functionality and learning not leaving private keys inside the contents of the app. Also I learned not to add shortcuts to a simple and readable procedure because in case the Intent Filter didnÂ´t exist I wouldnt be able to retreive the key that easily.